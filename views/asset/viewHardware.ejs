<!DOCTYPE html>
<html lang="en">
 
<head>

     <% include ../partials/head %>
       <% include assetheader %>
       <% include ../partials/adminheader %>
</head>
<style type="text/css">
   .dataTables_filter, .dataTables_length {
     display: none;
    }
</style>
<body >
 
 <div class="container-fluid secondry-color" style="padding-top:1%">
 
  
  <a href="/hardware" type="button" title="Add New Stationary"  value="Addstationary"><img   class="addNewPlus" ></a>
    
     <span class="modal-title" style="padding-left:41%;">List Of All Hardware</span>
 <input class="form-text-box" type="text" placeholder="search in this table" id="searchbox" style="float:right;width: 13%"> 
  <table class="table table-hover table-striped table-bordered rceDataTable"id="hardtable" cellpadding="0" cellspacing="0" border="0"style="width:100%">
    <thead>

      <tr>
        <th style='background-color:grey;color:white'>Hardware Type</th>
        <th style='background-color:grey;color:white'>Quantity</th>
        <th style='background-color:grey;color:white'>Vendor</th>
        <th style='background-color:grey;color:white'>Invoice Date</th>
        <th style='background-color:grey;color:white'>Invoice No.</th>
        <th style='background-color:grey;color:white'>Invoice Amount</th>
        <th style='background-color:grey;color:white'>Purchase Order</th>
        <th style='background-color:grey;color:white'>Delivery Date</th>
        <th style='background-color:grey;color:white'>Edit/Delete</th>
      </tr>
      <tbody>
        <%for(var i=0;i<htype.length;i++){%>
        <tr>
          <td><%=htype[i].componentName%></td>
          <td><%=htype[i].quantity%></td>
          <td><%=htype[i].vendor%></td>
          <td><%=((htype[i].invoiceDate).toString()).slice(3,16)%></td>
          <td><%=htype[i].invoiceNo%></td>
          <td><%=htype[i].invoiceAmt%></td>   
          <td><%=htype[i].purchaseOrder%></td>
          <td><%=((htype[i].deliveryDate).toString()).slice(3,16)%></td>
          <td>
            <a data-toggle='modal' data-target='#editHardware' onclick="edit(<%=htype[i].id%>)">
              <span class='glyphicon glyphicon-pencil' style='color:green;height:10px;'  title ='Edit'></span>
            </a>
             <a data-toggle='modal' data-target='#editHardware1' onclick="description(<%=htype[i].id%>)">
              <span class='glyphicon glyphicon-list' style='color:green;height:10px;'  title ='Description'></span>
            </a>
            <a onclick="del(<%=htype[i].id%>)" type="button"><span class='glyphicon glyphicon-trash' style='color:red;height:10px;'title='Delete'></span>
            </a>
          </td>
        </tr>
        <%}%>

      </tbody>
    </table>
</div>

</div>
</body>
<footer>
  <% include ../partials/footer %>

</footer>







<!-- Add Hardware starts-->
<div class="modal fade" id="editHardware" role="dialog" >
    <div class="modal-dialog"  style="margin-left: 150px">
      <!-- Modal content-->
      <div class="modal-content" id="express2" style ="width:1000px;height:auto;">
        <div class="modal-header" style="background-color:#f05f40;">
          <center><label id="head4" class="modal-title" style="color:white;font-size:14pt;"><b>Edit Hardware</b></label>
          <span id="dismiss"  data-dismiss="modal"  class="glyphicon glyphicon-remove" style='font-size:14pt;float:right;color:black;margin-bottom: 15px'></span>
          </center>
        </div>
        <div id="err" class="col-lg-6 col-sm-offset-3"></div>
          <div class="modal-body">
           <table class="table"><tr><td><td>
                <label class="form-Label" >Hardware Type: *</label></td>
             <td>
                <input type="text" id="type1"   name="type1"  class="form-text-box" value="" disabled>
               <input type="hidden" id="type"   name="type"  class="form-control" value="" disabled>             
              </td></td><td><td>
                <label class="form-Label" >Quantity: *</label></td>
             <td>
                <input type="number" maxlength="2"  class="form-text-box" id="qty" name="qty" onchange="addline()" />
              </td></td><td><td>
                <label class="form-Label">Vendor: *</label></td>
            <td>
                <input type="text" maxlength="50"  class="form-text-box" id="vendor" name="vendor"/>
             </td></td></tr><tr><td><td>
                <label class="form-Label">Invoice Number: *</label>
              </td><td>
                <input type="text" maxlength="10"  class="form-text-box" id="invoiceNo" name="invoiceNo" />
                </td></td><td><td>
                <label class="form-Label">Invoice Date: *</label>
             </td><td>
                <input type="text" class="form-text-box date"id="Invoicedate" name="Invoicedate" />
             </td></td><td><td>
                <label class="form-Label">Invoice Amount: *</label>
              </td><td>
                <input type="text" maxlength="11"  class="form-text-box" id="invoiceAmt" name="invoiceAmt" />
              </td></td></tr><tr><td><td>
                <label class="form-Label">Purchased Order: *</label>
             </td><td>
                <input type="text" maxlength="50"  class="form-text-box" id="order" name="order" />
            </td></td><td><td>
             <input type="hidden" maxlength="50"   id="headerId"  />
           
                <label class="form-Label">Delivery Date: *</label>
           </td><td>
                <input type="text " class="form-text-box date" id="Deliverydate"name="Deliverydate" />
            </td></td></tr></table>
            
             <div class="form-group">
             <div class=" col-md-12 table-responsive">
             <table id='table1' class="table table-striped table-bordered table-hover table-condensed hide"style="overflow:scroll;width:100%;">
             <thead id="headi">
             </thead>
             <tbody id="bodyi">
             </tbody>
             </table>
             </div>
             </div>
             </div>
            <div class="modal-footer"style="border-top:0px;">
              <center>
              <input type="text" class="hide" value="" id="hdnId" name="hdnId">
                <button id="cancel"type="reset"data-dismiss="modal"class="btn btn-default" style="background-color:#f05f40;color:black;padding-top: 4px; width:100px;height:30px;margin-top:10px;color:white">Cancel</button>
                <input type="submit"   onclick="return validatehardvare()"class="btn btn-default"style="margin-top:10px;background-color:#f05f40;color:black;padding-top:4px; width:100px;height:30px;color:white" value="Submit">
              </center>
            </div>
          </div>
        </div>
      </div>
  



    <!---->
    <div class="modal fade" id="editHardware1" role="dialog" >
    <div class="modal-dialog"  style="margin-left: 150px">
      <!-- Modal content-->
      <div class="modal-content" id="express2" style ="width:1000px;height:auto;">
        <div class="modal-header" style="background-color:#f05f40;">
          <center><label id="head4" class="modal-title" style="color:white;font-size:14pt;"><b>View Hardware</b></label>
          <span  data-dismiss="modal"  class="glyphicon glyphicon-remove" style='font-size:14pt;float:right;color:black;margin-bottom: 15px'></span>
          </center>
        </div>
        <div id="err" class="col-lg-6 col-sm-offset-3"></div>
          <div class="modal-body">
            <div class="col-md-12 a">
              <div class="col-md-2">
                <label style="line-height:42px !important;color:red; font-size: 12px">Hardware Type: </label>
              </div>
             <div class="col-md-2">
                <label id="t1" style="line-height:42px !important; font-size: 12px"></label>
              </div>
              <div class="col-md-2">
                <label style="line-height:42px !important;color:red; font-size: 12px">Quantity:</label>
              </div>
              <div class="col-md-2">
                <label id="t2" style="line-height:42px !important; font-size: 12px"></label>
              </div><div class="col-md-2">
                <label style="line-height:42px !important;color:red; font-size: 12px">Vendor:</label>
              </div><div class="col-md-2">
                <label id="t3" style="line-height:42px !important; font-size: 12px"></label>
              </div>
              <div class="col-md-12 a">
              <div class="col-md-2">
                <label style="line-height:42px !important; color:red;font-size: 12px">Invoice Amount:</label>
              </div>

              <div class="col-md-2">
                <label id="t4" style="line-height:42px !important; font-size: 12px"></label>
              </div>
          
             
             
              <div class="col-md-2">
                <label style="line-height:42px !important;color:red; font-size: 12px">Purchase Order: </label>
              </div>
             <div class="col-md-2">
                <label id="t5" style="line-height:42px !important; font-size: 12px"></label>
              </div>
              <div class="col-md-2">
                <label style="line-height:42px !important;color:red; font-size: 12px">Invoice Date:</label>
              </div>
              <div class="col-md-2">
                <label id="t6" style="line-height:42px !important; font-size: 12px"></label>
              </div>
              </div>
              <div class="col-md-12 a">
              <div class="col-md-2">
                <label style="line-height:42px !important;color:red; font-size: 12px">Invoice Number:</label>
              </div><div class="col-md-2">
                <label id="t7" style="line-height:42px !important; font-size: 12px"></label>
              </div><div class="col-md-2">
                <label style="line-height:42px !important; color:red;font-size: 12px">Delivery Date:</label>
              </div>
              <div class="col-md-2">
                <label id="t8" style="line-height:42px !important; font-size: 12px"></label>
              </div>
          
             </div>
             <div id='componentid'>
                <table id ='addComptable1' class="table table-striped table-bordered table-hover table-condensed" style="overflow-y:auto;">
            <col width="10"><col width="10"><col width="20"><col width="10"><col width="10">

                <thead id="modalHead">
                  <tr>
                    <th style="width:15%;">Component Name</th>
                    <th style="width:15%">Serial Number</th>
                    <th style="width:15%;">Brand</th>
                    <th style="width:15%">Warranty</th>
                    <th style="width:20%">Attribute</th>
                    <th style="width:20%">Attribute Value</th>
                  </tr>
                </thead>
                <tbody id="addcompobody1">
                </tbody>
              </table>
             </div>
             </div>
            <div class="modal-footer"style="border-top:0px;">
              <center>
                <button id="cancel"type="reset"data-dismiss="modal"class="btn btn-default" style="background-color:#f05f40;color:black;padding-top: 4px; width:100px;height:30px;margin-top:10px;color:white">Cancel</button>
              </center>
            </div>
          </div>
        </div>
      </div>
      </div>
   








    <!-- View More Details starts-->

<div class="modal fade" id="viewMore" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content" id="express3">
        <div class="modal-header" style="background-color:#f05f40;">
          <center><label id="head4" class="modal-title" style="color:white;font-size:14pt;"><b>View More</b></label></center>
        </div>
        <div id="err" class="col-lg-6 col-sm-offset-3"></div>
          <div class="modal-body">
            <table class="table table-striped table-bordered table-hover table-condensed hide"style="overflow:scroll;width:100%;">
        <thead id="headi">
        </thead>
        <tbody id="bodyi">
        </tbody>
        </table>

            <div  class="modal-footer"style="border-top:0px;">
              <center>
              <input type="text" class="hide" value="" id="hdnId" name="hdnId">
                <button id="cancel"type="reset"data-dismiss="modal"class="btn btn-default" style="background-color:#f05f40;color:black;padding-top: 4px; width:100px;height:30px;margin-top:10px;color:white">Cancel</button>
                <input type="submit" onclick="return validatehardvare()"class="btn btn-default"style="margin-top:10px;background-color:#f05f40;color:black;padding-top:4px; width:100px;height:30px;color:white" value="Submit">
              </center>
            </div>
          </div>
        </div>
      </div>
    </div>




<div class="modal " id="addModal"  role="dialog">
  <div class="modal-dialog" style="display:table;height:95%;">
    <!-- Modal content-->
    <div class="modal-content" id="express2" style="height:350px;width:800px">
      <div class="modal-header" style="background-color:#f05f40;">
        <center><label id="head4" class="modal-title" style="color:white;font-size:14pt;"><b>Add Component</b></label>
        <span  data-dismiss="modal"  class="glyphicon glyphicon-remove" style='font-size:14pt;float:right;color:black;margin-bottom: 15px'></span>
        </center>
      </div>
      <div id="err" class="col-lg-6 col-sm-offset-3"></div>
      <div class="modal-body">
        <div class="form-group">
          <div class=" col-md-12 table-responsive">
          <!-- <h3>Specifications</h3> -->
        <!-- <input type="button" onclick="addRow()" value="ADD"> -->
            <table id ='addComptable' class="table table-striped table-bordered table-hover table-condensed" style="overflow-y:auto;">
            <col width="10"><col width="10"><col width="20"><col width="10"><col width="10">

                <thead id="modalHead">
                  <tr>
                    <th style="width:20%;">Component</th>
                    <th style="width:20%;">Serial No.</th>
                    <th style="width:170px;">Brand</th>
                    <th style="width:20%">Warranty</th>
                    <th style="width:20%">Size</th>
                  </tr>
                </thead>
                <tbody id="addcompobody">
                </tbody>
              </table>
              <input type="hidden" id="serids">
              <input data-dismiss="modal" type="button"class="btn btn-info" onclick="saveComp()" value="SUBMIT">
             <input type="button"class="btn btn-info" onclick="addCompModal()" value="ADD">

            </div>
          </div>
        </div>
    </div>
  </div>
</div>



    <!-- View More Details ends-->


















    <script>

   var col;
var comps=[];
var qty;
var attlength;
var allAttIds = [];
var allAttIds1 = [];
var arr=[];
var countAddCompModal=0;
  var fact=0;  


    




    $(document).ready(function(){
       $('.asset-img').addClass('active');
   var oTable=   $("#hardtable").dataTable({
        "bLengthChange": false,
        "binfo":false
      });
             $("#searchbox").keyup(function() {
        oTable.fnFilter(this.value);
      });
     var oTable1= $("#addComptable").dataTable({
        "bLengthChange": false,
        "binfo":false
      });
             $("#searchbox").keyup(function() {
        oTable1.fnFilter(this.value);
      });
      //getlinedtata();
    });

    jQuery('.date').datetimepicker({
      timepicker:false,
      format:'Y-m-d'
    });
    function validate(){
      var inamount=$('#invoiceAmt').val();
      var up=$('#uprice').val();
      if($('#vendor').val().length<1||$.trim($("#vendor").val()) =="") 
      {
      alert("Vendor is Missing!");    
      return false;
      }
    if($('#Invoicedate').val().length<1||$.trim($("#Invoicedate").val()) =="") 
    {
      alert("Invoice date is Missing!");    
      return false;
    }
     if($('#invoiceNo').val().length<1||$.trim($("#invoiceNo").val()) =="") 
    {
      alert("Invoice number is Missing!");    
      return false;
    }

    if(inamount.length<2||isNaN(inamount)||inamount.trim().length<1) 
    {
      alert("Enter valid Invoice Amount!");    
      return false;
    }
    if($('#qty').val().length<1||$.trim($("#qty").val()) ==""||$.trim($("#qty").val()) > 20) 
    {
      alert("Enter valid Quantity!");    
      return false;
    }
        
    if($('#Deliverydate').val().length<1||$.trim($("#Deliverydate").val()) =="") 
    {
      alert("Delivery date is Missing!");    
      return false;
    }

   // parsealldata();
 /* $.ajax({
    url: '/updateHardware',
    method: 'POST',
    data: {
      "type": $('#type').val(),
      "qty": $('#qty').val(),
      "vendor": $('#vendor').val(),
      "Invoicedate": $('#Invoicedate').val(),
      "invoiceNo": $('#invoiceNo').val(),
      "invoiceAmt":  $('#invoiceAmt').val(),
      "Deliverydate":$('#Deliverydate').val(),
      "id":$("#hdnId").val()
    },
    success: function(data){
      alert("Furniture successfully updated");
      window.location.reload();      
    },
    dataType: 'JSON'    
  });*/
}

function saveId(id){
    addId(id);
    }

function addId(ids){
  $('#serids').val(ids);
 }

function del(id){ 
  //alert(id);
  if(confirm("This action once done cannot be undone! Do you want to delete this?")==true)
  {
  $.ajax({
    url:'/deleteHeaderandline',
    method: 'POST',
    data:{'id':id},
    success: function(data) {
     // window.location.reload();
     window.location.href='/viewHardware'
    },
    dataType: 'JSON',
  });
}
}

function description(id){
  
 // $("#hdnId").val('');
      $("#t1").html('');
      $("#t2").html('');
      $("#t3").html('');
      $("#t4").html('');
      $("#t5").html('');
      $("#t6").html('');
      $("#t7").html('');
      $("#t8").html('');
  //alert(id);
  $.ajax({ 
    url: '/getEditHardware',
    method:'POST',
    data: {'id':id},
    success: function(data) { 
      console.log("edit info----------------",data[0][0].componentName);
      $("#type").val(data[0][0].ACID);
      $("#t1").append(data[0][0].componentName);
      $("#t2").append(data[0][0].quantity);
      $("#t3").append(data[0][0].vendor);
      $("#t4").append(data[0][0].invoiceAmt);
      $("#t5").append(data[0][0].purchaseOrder);
      $("#t6").append(((data[0][0].invoiceDate).toString()).slice(0,11));
      $("#t7").append(data[0][0].invoiceNo);
      $("#t8").append(((data[0][0].deliveryDate).toString()).slice(0,11));
      //$("#hdnId").val(data[0][0].id);
      //getlinedtata();
      //getlineValue(id);
      getidfordescription(id);
    }
  });
}

function edit(id){
  
  $("#hdnId").val('');
  //alert(id);
  $.ajax({ 
    url: '/getEditHardware',
    method:'POST',
    data: {'id':id},
    success: function(data) { 
      console.log("edit info----------------",data[0][0].componentName);
      $("#type").val(data[0][0].ACID);
      $("#type1").val(data[0][0].componentName);
      $("#qty").val(data[0][0].quantity);
      $("#vendor").val(data[0][0].vendor);
      $("#invoiceAmt").val(data[0][0].invoiceAmt);
      $("#order").val(data[0][0].purchaseOrder);
      $("#Invoicedate").val(data[0][0].invoiceDate);
      $("#invoiceNo").val(data[0][0].invoiceNo);
      $("#Deliverydate").val(data[0][0].deliveryDate);
      $("#hdnId").val(data[0][0].id);
      getlinedtata();
      getlineValue(id);
    }
  });
}

function addline(){
 var id=$("#hdnId").val();
  getlinedtata();
  getlineValue(id);
}

function getlinedtata(){
      var qty=$("#qty").val(); 
       var selectedValue = $("#type").val();
      $.ajax({
        url:'/getAttr',
        method:'post',
                data:{acid:selectedValue},
                dataType:'json',
                success:function(result){
                  
                  $('#headi').empty();
                  var head='<tr ><th>#</th><th >Serial No.</th>';
                  allAttIds = [];
                  for(var i=0;i<result[0].length;i++){
                    console.log('head'+i)
                    head=head+'<th>'+result[0][i].attribute+'</th>';
                  allAttIds.push(result[0][i].attId);
                  }
                  allAttIds1=allAttIds;
                  //alert(allAttIds1);
                  //allAttIds.push(0);
        /********************Important next line*************************/
            head=head+'<th >Brand</th><th style = "width:100px;" id ="underconsideration">Warranty</th><th class = "">Components</th></tr>';
            $('#headi').append(head);
            $('#bodyi').empty();
        arr.length=qty;
        col=result[0].length;
       attlength = col;
        for(var i=0;i<qty;i++){
          var k=i
          var row='<tr><td>'+ ++k +'</td><td><input class="form-text-box"'+
          ' id="serial'+i+'"></td>';
          for(var o=0;o<result[0].length;o++){

           row=row+'<td><select class="form-text-box" id="'+i+o+'">';

           
          for(var dropdownValues=0;dropdownValues<result[1].length;dropdownValues++){
                 if(result[0][o].attId==result[1][dropdownValues].attId){
              row=row+'<option value="'+result[1][dropdownValues].id+'">'+result[1][dropdownValues].value+'</option>';          
                 }

              }
              row = row + '</select></td>';
          
          }

    /*******************Code by Mayur for brandname and warranty***************************/
         // var k = 0;while(result[1][k++].attId!=0);
         // k--;


              row=row+'<td><select class="form-text-box" id="brand'+i+'">';
            
           for(var dropdownValues=0;dropdownValues<result[2].length;dropdownValues++){
             row=row+'<option value="'+result[2][dropdownValues].id+'">'+result[2][dropdownValues].value+'</option>';  
           }
          row = row + '</select></td><td><input'+
        ' class="form-text-box  warrClass" id="warranty'+i+'" type = "text"></td>';
           row = row + '<td class="hide"><input'+
        ' class="form-text-box warrClass" id="componentdata'+i+'" type = "hidden"></td>';
        row = row + '<td class="hide"><input'+
        ' class="single form-text-box warrClass" id="id'+i+'" type = "hidden" value="0"></td>';
      /******************************************************************************/



            row = row + '<td class = "">'+'<input class="btn btn-danger"type="button"data-toggle="modal"'+' value="EDIT"data-target="#addModal"'+'style="background-color:#f05f40;color:white;height:20px;font-size:12px" id="'+i+'"'+
            ' onclick="getsubline('+i+')">'+
            '</td></tr>';

         // addId(i);
          $('#bodyi').append(row);
                    }

          
          $('#table1').removeClass('hide');
          arr[i]={
                    specification:null,
                    brand:null,
                    serial:null,warranty:null,
                    component:{},
                    saved:false
                }
                
         }

      });
    }

    function getlineValue(id){
 
   $.ajax({
        url:'/getlineid',
        method:'post',
        async:true,
        data:{
            'id':id
             },
                dataType:'json',
                success:function(result){
                 var lineid=[];
                 lineid=result[0][0].ids.split(',');
                // alert(lineid);
               for(var i=0;i<lineid.length;i++){
              getattrline(lineid[i],i);
             }
                                      }

});
}


 function getidfordescription(id){
 $('#addcompobody1').html(' ');
   $.ajax({
        url:'/getlineid',
        method:'post',
        async:true,
        data:{
            'id':id
             },
                dataType:'json',
                success:function(result){
                 var lineid=[];
                 lineid=result[0][0].ids.split(',');
                // alert(lineid);
               for(var i=0;i<lineid.length;i++){
             // getattrline(lineid[i],i);
              getcomponentfordescription(lineid[i]);
             }
                                      }

});
}

 /*function getbrand()
  {
 
   $.ajax({
        url:'/getbrand',
        method:'post',
        async:true,
       
                dataType:'json',
                success:function(result)
                {
                  var att='';
                   $('.branddrop1').html('');
                  for(var j=0;j<result[0].length;j++)
                  {
                      
                      att='<option value='+result[0][j].id+'>'+result[0][j].value+'</option>';
                       $('.branddrop1').append(att);
                  }
               }

         });
  }*/



  function getattrline(id,nu)
  {
 
   $.ajax({
        url:'/getlinevalue',
        method:'post',
        async:true,
        data:{
            'id':id
             },
                dataType:'json',
                success:function(result)
                {
                  //alert(result[0][0].name);
                 // getsubline(result[0][0].Id);
                  $('#id'.concat(nu)).val(id);
                  $('#serial'.concat(nu)).val(result[0][0].serialNo);
                  $('#brand'.concat(nu)).val(result[0][0].id);
                  $('#warranty'.concat(nu)).val(result[0][0].warranty);
                  for(var j=0;j<result[2].length;j++)
                  {
                      $('#'.concat(nu).concat(j)).val(result[2][j].id);

                  }
               }

         });
  }

 function getsubline(k)
 {
  //
  $("#addComptable").dataTable().fnDestroy();
  $('#addcompobody').empty();
  countAddCompModal=0;
 var str1='';
  var id=$('#id'.concat(k)).val();
 //alert(id);
   $.ajax({
        url:'/getsublinevalue',
        method:'post',
        async:true,
        data:{
            'id':id
             },
                dataType:'json',
                success:function(result)
                { saveId(k); 
                   for(var i=0;i<result[0].length;i++)
                   { // alert(result[0][i].brand);
                      addCompModal();
                      $('#compo'.concat(i)).val(result[0][i].ACID);
                      $('#srno'.concat(i)).val(result[0][i].serialNO);
                      $('#brand1'.concat(i)).val(result[0][i].brand);
                      $('#war'.concat(i)).val(result[0][i].warranty);
                      $('#sublineid'.concat(i)).val(result[0][i].id);
                      str1=str1+result[0][i].ACID+','+result[0][i].serialNO+','+result[0][i].brand+','+result[0][i].warranty+','+result[0][i].id+'?';              
                   }
                   $('#componentdata'.concat(k)).val(str1);
                  
                      console.log('jai mata di',result[0]);
                }

          });
}

 function getcomponentfordescription(id)
 {
 
 
   $.ajax({
        url:'/getcomponentfordescription',
        method:'post',
        async:true,
        data:{
            'id':id
             },
                dataType:'json',
                success:function(result)
                {  
                  
                  // $('#componentid').append(result[0][0].componentName,result[0][0].name,result[0][0].warranty,result[0][0].serialNo);
                   var di='';
                  /* di=di+'<div class="col-md-12 a"> <div class="col-md-2">  <label style="line-height:42px !important;color:red; font-size: 12px">Hardware Type: </label></div><div class="col-md-2"><label id="t1" style="line-height:42px !important; font-size: 12px">'+result[0][0].componentName+'</label></div><div class="col-md-2"> <label style="line-height:42px !important;color:red; font-size: 12px">Brand Name:</label></div><div class="col-md-2"><label id="t2" style="line-height:42px !important; font-size: 12px">'+result[0][0].name+'</label> </div><div class="col-md-2"><label style="line-height:42px !important;color:red; font-size: 12px">Warranty:</label></div><div class="col-md-2"><label id="t3" style="line-height:42px !important; font-size: 12px">'+result[0][0].warranty+'</label> </div><div class="col-md-12 a"> <div class="col-md-2">  <label style="line-height:42px !important;color:red; font-size: 12px">Tag Number: </label></div><div class="col-md-2"><label id="t1" style="line-height:42px !important; font-size: 12px">'+result[0][0].serialNo+'</label></div>';*/
                    var  atter='';
                     var value='';
                   for(var j=0;j<result[2].length;j++){
                    
                    atter=atter+result[2][j].attribute+',';
                    value=value+result[3][j].value+',';
                    }
                   di=di+'<tr><td>'+result[0][0].componentName+'</td><td>'+result[0][0].serialNo+'</td><td>'+result[0][0].name+'</td><td>'+result[0][0].warranty+'</td><td>'+atter+'</td><td>'+value+'</td></tr>';
                   $('#addcompobody1').append(di);
                  /* di=di+'<div class="col-md-2"> <label style="line-height:42px !important;color:red; font-size: 12px">attribute:</label></div><div class="col-md-4"><label id="t2" style="line-height:42px !important; font-size: 12px">'+atter+'</label> </div></div><div class="col-md-12 a"><div class="col-md-2"><label style="line-height:42px !important;color:red; font-size: 12px">attribute value:</label></div><div class="col-md-4"><label id="t3" style="line-height:42px !important; font-size: 12px">'+value+'</label> </div>' ;
                   $('#componentid').append(di);*/
                  
                    
                }

          });
}


function validatehardvare(){
  if($('#vendor').val().length<1||$.trim($("#vendor").val()) =="") 
  {
    alert("Vendor is Missing!");    
    return false;
  }

  else if($('#invoiceNo').val().length<1||$.trim($("#invoiceNo").val()) =="") 
  {
    alert("Invoice No Missing!");    
    return false;
  }

  else if($('#Invoicedate').val().length<1||$.trim($("#Invoicedate").val()) =="") 
  {
    alert("Invoice date Missing!");    
    return false;
  }

  else if($('#invoiceAmt').val().length<1||$.trim($("#invoiceAmt").val()) =="") 
  {
    alert("Invoice Amount Missing!");    
    return false;
  }

  else if($('#order').val().length<1||$.trim($("#order").val()) =="") 
  {
    alert("Placed order Missing!");    
    return false;
  }

  else if($('#Deliverydate').val().length<1||$.trim($("#Deliverydate").val()) =="") 
  {
    alert("Delivery date Missing!");    
    return false;
  }
  else
    for(var i=0;i<document.getElementById('qty').value;i++){
    if($('#serial'.concat(i)).val()==''){
      alert('Serial Number Missing!');
      return false;
    }
    else if($('#warranty'.concat(i)).val()==''){
      alert('Warranty Missing!');
      return false;
    }
    else if(i==((document.getElementById('qty').value)-1)){
     parsealldata(); 
    }
  }
  
}


  function addCompModal()
  {
    
    var row = '<tr><td><select class = "form-text-box" id="compo'+countAddCompModal+'"><%for(var i=0;i<ctype.length;i++){%><option value="<%=ctype[i].id%>"><%=ctype[i].componentName%></option><%}%></select></td><td><input type = "text" class = "form-text-box" id="srno'+countAddCompModal+'"></td><td><select class="branddrop1 form-text-box" style="width:170px"  id="brand1'+countAddCompModal+'"><%for(var i=0;i<brandtype.length;i++){%><option value="<%=brandtype[i].id%>"><%=brandtype[i].value%></option><%}%></select></td><td><input type = "text" class = "form-text-box" id="war'+countAddCompModal+'"></td><td><input type = "text" class = "form-text-box" id="size'+countAddCompModal+'"></td></tr><input type="hidden" id="sublineid'+countAddCompModal+'" value="0">';
     $('#addcompobody').append(row);
   
         countAddCompModal++;

  }


       function saveComp()
       {

           tempArr=[];
           var str='';
           for(var  i=0;i<countAddCompModal;i++)
           {
               str=str+$('#compo'.concat(i)).val()+','+$('#srno'.concat(i)).val()+','+$('#brand1'.concat(i)).val()+','+$('#war'.concat(i)).val()+','+$('#size'.concat(i)).val()+','+$('#sublineid'.concat(i)).val();
               tempArr[i]=str;
               str='?';
           }
           $('#componentdata'.concat($('#serids').val())).val(tempArr);
          // alert(tempArr);
       }


       function parsealldata(){
    var q=$('#qty').val();
    var str2='';
    var str1='';
    dataArray=[];
   
    for(var i=0;i<q;i++){
      for(var j=0;j<allAttIds1.length;j++){
   str2=str2+$('#'.concat(i).concat(j)).val()+',';}
   //+','+$('#warranty'.concat(i)).val()+'@'+$('#componentdata'.concat(i)).val();$('#serial'.concat(i)).val()+','+
   str1=str2+'$';
   str2='';
   dataArray[i]=str1;
   //str1='$';
    }
   // alert(dataArray);
    addHardware(dataArray);
  }

/*******update hardware**********/
  function addlinedata(t1,t2,t3,t6,t7,headid,ctypeid,arr1,ide){
    //alert('hello line data');
    //alert(arr1);
   var arr3=[];
   arr3=arr1.split('?');
   //alert(arr3.length);
    var arr2=[];

   $.ajax({
        url:'/addline',
        method:'post',
        async:true,
        data:{
            't1' : t1,
            't2': t2,
            't3' : t3,
             't6' : t6,
             't7' : t7,
             'hdId' : headid,
             'ctype':ctypeid,
             'ides':ide

             },
                dataType:'json',
                success:function(result){
                  //alert(result);
                  //arr3=arr1.split('?');
                    for(var i=0;i<arr3.length;i++){
                      var arrayforsucess=arr3.length;
                     // alert(arrayforsucess);
                       var increment=arr3.length-1;
                       var n=i;
                      arr2=arr3[i].split(',');
                       if(arrayforsucess!=0){
                     
               addsubline(arr2[0],arr2[1],arr2[2],arr2[3],arr2[4],headid,ctypeid,result,arr2[5],increment,n);}
                else{
                    if(fact==($('#qty').val())){
                    alert('update data successfully');}
                   }
                     }
             
             }

});
}
function addsubline(st1,st2,st3,st4,st5,headerid,ctypeid,lineid,ides,lni1,n1){
 // allAttIds = allAttIds.join(',');
 //alert('addcomponent');
 
 // console.log("hfshgfshgdsh sshh",st1,st2,st3,st4,st5,headerid,ctypeid,lineid,ides);
   $.ajax({
        url:'/subaddline',
        method:'post',
        async:true,
        data:{
            'st1' : st1,
            'st2': st2,
            'st3' :st3,
            'st4' : st4,
            'st5'  : st5,
             'hdId' : headerid,
             'ctype':ctypeid,
             'lineid':lineid,
             'ides':ides
             },
                dataType:'json',
                success:function(result){
                  if((fact==$('#qty').val())&&(lni1==n1)){
                 t++;
                
                 if(t==fact){
             alert('data update successfully ');
              $('#dismiss').click();
           }
           }
                                      }

});
}

function addtag(ides){
var  tagNo='PSSL'+ides;
   $.ajax({
        url:'/updateTag',
        method:'post',
        async:true,
        data:{
            'tagNo' : tagNo,
             'ides':ides
             },
                dataType:'json',
                success:function(result){
                 
             alert('data add successfully ');
            //($("#editHardware").modal()).close();
            $('#dismiss').click();
                                      }

});
}
function addHardware(newOuterArr){
 // allAttIds = allAttIds.join(',');
  t=0;
 var array=[];
 var newarray=[];
 var compdata=[];
 var linedata=[];
 var sublinedata=[];
  var len=$('#qty').val();


   $.ajax({
        url:'/addHardware',
        method:'post',
        async:true,
        data:{
            'attr':newOuterArr,
            'type' : $('#type').val(),
        'invoiceNo': $('#invoiceNo').val(),
  'purchasedOrder' : $('#order').val(),
        'Quantity' : $('#qty').val(),
    'invoiceDate'  : $('#Invoicedate').val(),
    'deliveryDate' : $('#Deliverydate').val(),
    'vendor'       : $('#vendor').val(),
    'invoiceAmt'   : $('#invoiceAmt').val(),
    'ides': $("#hdnId").val()
             },
                dataType:'json',
                success:function(result){
                 for(var i=0;i<len;i++){
                   fact++;
 array=newOuterArr[i].split("$");
// alert(array[0]);
 //alert($('#componentdata'.concat(i)).val());
 var attid= allAttIds1.toString();
 //alert(array[0]);allAttIds1
 /*alert(array[1]);
 newarray=array[1].split("@");
 linedata[i]=newarray[0];
 sublinedata[i]=newarray[1];
 alert(linedata[i]);
 compdata=newarray[0].split(",");
 alert(compdata[0]);*/
 //+','+$('#warranty'.concat(i)).val()+'@'+$('#componentdata'.concat(i)).val();$('#serial'.concat(i)).val()+','+
//console.log(compdata[0],compdata[1],compdata[2],compdata[3],compdata[4],compdata[5],compdata[6],result,$('#typel').val());
          addlinedata($('#serial'.concat(i)).val(),attid,array[0],$('#brand'.concat(i)).val(),$('#warranty'.concat(i)).val(),result,$('#type').val(),$('#componentdata'.concat(i)).val(),$('#id'.concat(i)).val());

             
                                      }
                                      }

});
}
/*********end***********/

</script>